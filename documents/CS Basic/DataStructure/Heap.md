# 힙(Heap)

![https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Max-Heap.svg/1002px-Max-Heap.svg.png](https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Max-Heap.svg/1002px-Max-Heap.svg.png)

자료구조 에서 힙은 최소 힙, 또는 최대 힙을 의미한다. 힙은 원소들 중에서 최솟값 혹은 최댓값을 빠르게 찾기 위하여 고안되었으며 완전 이진 트리를 기반으로한 자료구조이다. 즉 힙은 다음과 같은 속성을 만족하는 완전한 트리로 구성된다. (보통은 완전이진트리를 이용하지만 완전 N진 트리를 사용하지 못 하는 것은 아니다)

- A와 B가 부모-자식 간의 관계에 있다면 A와 B의 값은 대소관계가 성립한다.(최소힙인 경우 A<B, 최대힙인 경우 A>B)

위 대소관계는 부모-자식 간에만 성립하며 형제 노드 끼리는 아무런 대소관계가 성립하지 않는다.

이렇게 되면 루트 노드는 원소들 중 항상 최댓값 혹은 최솟값을 가지게 된다.

이런 성질을 이용하여 우선순위 큐 같은 추상적인 자료형을 구현할 수 있다.

# 이진 최대 힙

이진 최대 힙의 동작에 대해서 이해한다면 최소 힙이나 N진 힙에 대해서도 쉽게 이해할 수 있다. 

최대 힙은 마지막 단계에서 오른쪽 부분을 제한 부분이 가득 채워져 있다는 점에서 완전 이진 트리 이다. 최대 힙 에서는 다음과 같은 두 가지 연산이 존재한다.

- 삽입(insert)
- 최대 값 반환(extract_max)

## 삽입

최대 힙에 삽입할 때에는 항상 트리의 마지막 레벨의 마지막 부분에 원소를 삽입한다. 완전 이진 트리 이기 때문에 새로운 원소는 항상 밑바닥 가장 오른쪽 위치로 삽입이 된다. (위 트리 이미지의 경우 노드 3의 왼쪽 자식 노드로 삽입)

이 후 새로 삽입된 노드가 최대 힙의 성질에 위배 되지 않도록 제대로 된 자리를 찾을 때 까지 부모 노드와 값을 비교하여 교환한다. 이런 방식으로 삽입된 노드는 위로 올라가게 된다.

힙에 있는 노드의 개수를 N개 라고 할 때 삽입 연산의 복잡도는 O(log N)이 된다.

## 최대 값 반환

최대 힙 에서 최댓값을 찾는 것은 간단하다. 무조건 루트노드가 원소들 중 최댓값을 가지고 있기 때문이다. 문제는 최댓값을 가지는 노드를 제거한 뒤에 힙을 어떻게 다시 최대 힙의 형태로 만들어 놓는가이다. 

최댓값을 가지는 루트노드를 반환한 뒤에는 가장 마지막 노드를 루트노드로 교환한다. 이 후 최대 힙의 성질을 만족 하도록 자식 노드와 값을 비교하여 교환한다. 왼쪽 오른쪽 자식 노드 중에서는 최대 힙의 성질에 따라 더 큰 자식노드와 비교하여 교환한다.

힙에 있는 노드의 개수를 N개라고 할 때 최댓값 반환의 복잡도는 O(log N)이 된다.

---

참고. 게일 라크만 맥도웰. 코딩 인터뷰 완전분석 (이창현 옮김) 

참고. "힙(자료구조)", Wikipedia
